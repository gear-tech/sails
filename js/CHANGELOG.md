# CHANGELOG

## 0.5.1

- Fixed: generation correct TransactionBuilder constructor calls (https://github.com/gear-tech/sails/pull/1070).
- Added an option to generate both program types and executable code within a single file (https://github.com/gear-tech/sails/pull/1073/files)
- Added a method available in the `TransactionBuilder` class that decodes responses from the program. (https://github.com/gear-tech/sails/pull/1071).
- Added a comment to exclude the generated code from linting. (https://github.com/gear-tech/sails/pull/1069)

## 0.5.0

### Breaking Changes

- Implemented `QueryBuilder` class that provides a convenient way to build and run Sails queries.

_From now query functions in `Sails` and in the lib generated by sails-js-cli return `QueryBuilder` class instead of the result of the query._

**Previous way:**
```typescript
const alice = 'kGkLEU3e3XXkJp2WK4eNpVmSab5xUNL9QtmLPh8QfCL2EgotW';
// Query function accepted originAddress, value, atBlock as direct parameters
const result = await sails.services.ServiceName.queries.QueryName(alice, null, null, functionArg1, functionArg2);
```

**New way:**
```typescript
const alice = 'kGkLEU3e3XXkJp2WK4eNpVmSab5xUNL9QtmLPh8QfCL2EgotW';
// Query function now accepts only function arguments and returns QueryBuilder
const result = await sails.services.ServiceName.queries.QueryName(functionArg1, functionArg2)
  .withAddress(alice)
  .call();

// All QueryBuilder methods are optional
const result = await sails.services.ServiceName.queries.QueryName(functionArg1, functionArg2).call();

// Full configuration example
const result = await sails.services.ServiceName.queries.QueryName(functionArg1, functionArg2)
  .withAddress(alice)
  .withValue(1000000000000n) // 1 VARA
  .withGasLimit(50000000000n)
  .atBlock('0x1234567890abcdef...')
  .call();
```

### Changes

- Fixed creating messages with a single argument (https://github.com/gear-tech/sails/pull/1051)

---

## 0.4.3

### Changes

- Skipped type file generation if types are not present in the IDL
- Improved encoding / decoding in the `TransactionBuilder` class
- Capitalized enum variant names in generated files
- From now gas can be calculated automatically when using `TransactionBuilder`'s method `singAndSend`

---

## 0.4.2
### Compatibility
- Sails-RS v0.8.1
- Gear v1.8.1

### Changes
- Bump `@gear-js/api` to `v0.42.0` in https://github.com/gear-tech/sails/pull/933
- Support `Program` class from `@gear-js/api` to keep track on program upgrades in https://github.com/gear-tech/sails/pull/933

---

## 0.4.1

### Compatibility
- Sails-RS v0.8.0
- Gear v1.8.0

### Changes
- Add explicit export of `IMethodReturnType` from `TransactionBuilder`

---

## 0.4.0

### Compatibility
- Sails-RS v0.8.0
- Gear v1.8.0

### Changes
- Support ReplyCode from `@gear-js/api` in https://github.com/gear-tech/sails/pull/893
From now on, `response` function will throw an error if the program's reply is successful.
- Update types in ctor generation (https://github.com/gear-tech/sails/issues/786)
- Unpin `sails-js` peer dependencies

---

## 0.3.2

### Compatibility
- Sails-RS v0.7.1

### Changes
- Ability to get `gasInfo` in `TransactionBuilder` in https://github.com/gear-tech/sails/pull/745

---

## 0.3.1

### Compatibility
- Sails-RS v0.7.0

### Changes
- Setup automated releases in https://github.com/gear-tech/sails/pull/608
- Update dependencies in https://github.com/gear-tech/sails/pull/709
