type ReferenceCount = struct {
  u32,
};

type DoThatParam = struct {
  p1: nat32,
  p2: actor_id,
  p3: ManyVariants,
};

type ManyVariants = enum {
  One,
  Two: u32,
  Three: opt u256,
  Four: struct {
    a: u32,
    b: opt u16,
  },
  Five: struct {
    str,
    h256,
  },
  Six: struct { u32 },
};

type ManyVariantsReply = enum {
  One,
  Two,
  Three,
  Four,
  Five,
  Six,
};

type TupleStruct = struct {
  bool,
};

constructor {
  /// Program constructor (called once at the very beginning of the program lifetime)
  Default : ();
  /// Another program constructor (called once at the very beginning of the program lifetime)
  New : (counter: opt u32, dog_position: opt struct { i32, i32 });
};

service PingPong {
  /// !@interface_id32 = 0xf54e9f71
  /// !@interface_uid64 = 0xa1d8097af54e9f71
  /// !@entry_id = 0x0001
  Ping : (input: str) -> result (str, str);
};

service Counter {
  /// !@interface_id32 = 0x3ceb4fca
  /// !@interface_uid64 = 0xd2836f0c3ceb4fca
  /// Add a value to the counter
  /// !@entry_id = 0x0001
  Add : (value: u32) -> u32;
  /// Substract a value from the counter
  /// !@entry_id = 0x0002
  Sub : (value: u32) -> u32;
  /// Get the current value
  /// !@entry_id = 0x0003
  query Value : () -> u32;

  events {
    /// Emitted when a new value is added to the counter
    /// !@entry_id = 0x0001
    Added: u32;
    /// Emitted when a value is subtracted from the counter
    /// !@entry_id = 0x0002
    Subtracted: u32;
  }
};

service Dog {
  /// !@interface_id32 = 0xe040e76a
  /// !@interface_uid64 = 0xe2b0c476e040e76a
  /// !@extends
  ///   MammalService (interface_id32=0xdfb5e49a, interface_uid64=0x79a38954dfb5e49a)
  ///   WalkerService (interface_id32=0xc30be965, interface_uid64=0x7403cbfcc30be965)
  /// !@entry_id = 0x0001
  MakeSound : () -> str;
  /// !@entry_id = 0x0002
  Walk : (dx: i32, dy: i32) -> null;
  /// !@entry_id = 0x0001
  query AvgWeight : () -> u32;
  /// !@entry_id = 0x0001
  query Position : () -> struct { i32, i32 };

  events {
    /// !@entry_id = 0x0001
    Barked;
    /// !@entry_id = 0x0001
    Walked: struct {
      from: struct { i32, i32 },
      to: struct { i32, i32 },
    };
  }
};

service References {
  /// !@interface_id32 = 0xc2404a66
  /// !@interface_uid64 = 0xb4bc456ec2404a66
  /// !@entry_id = 0x0001
  Add : (v: u32) -> u32;
  /// !@entry_id = 0x0002
  AddByte : (byte: u8) -> vec u8;
  /// !@entry_id = 0x0004
  GuessNum : (number: u8) -> result (str, str);
  /// !@entry_id = 0x0005
  Incr : () -> ReferenceCount;
  /// !@entry_id = 0x0008
  SetNum : (number: u8) -> result (null, str);
  /// !@entry_id = 0x0003
  query Baked : () -> str;
  /// !@entry_id = 0x0006
  query LastByte : () -> opt u8;
  /// !@entry_id = 0x0007
  query Message : () -> opt str;
};

service ThisThat {
  /// !@interface_id32 = 0x268e3913
  /// !@interface_uid64 = 0x7bff4fc7268e3913
  /// !@entry_id = 0x0001
  DoThat : (param: DoThatParam) -> result (struct { actor_id, nat32, ManyVariantsReply }, struct { str });
  /// !@entry_id = 0x0002
  DoThis : (p1: u32, p2: str, p3: struct { opt h160, nat8 }, p4: TupleStruct) -> struct { str, u32 };
  /// !@entry_id = 0x0003
  Noop : () -> null;
  /// !@entry_id = 0x0004
  query That : () -> result (str, str);
  /// !@entry_id = 0x0005
  query This : () -> u32;
};

service ValueFee {
  /// !@interface_id32 = 0x30287ae1
  /// !@interface_uid64 = 0x6d11dccf30287ae1
  /// Return flag if fee taken and remain value,
  /// using special type `CommandReply<T>`
  /// !@entry_id = 0x0001
  DoSomethingAndTakeFee : () -> bool;

  events {
    /// !@entry_id = 0x0001
    Withheld: u128;
  }
};

