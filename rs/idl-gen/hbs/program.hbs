program {{name}} {
    constructors {
        {{#each ctors}}
        {{#each docs}}
        /// {{{this}}}
        {{/each}}
        {{name}}({{#each args}}{{#if @index}}, {{/if}}{{name}}: {{{lookup @root.program.type_names type}}}{{/each}});
        {{#unless @last}}

        {{/unless}}
        {{/each}}
    }
    {{#if services}}

    services {
        {{#each services}}
        {{this}},
        {{/each}}
    }
    {{/if}}
    {{#if types}}

    types {
{{#each types}}
{{#if type.def.variant}}
        enum {{{lookup ../type_names id}}} {
        {{#each type.def.variant.variants}}
            {{name}}{{~#if fields}}
            {{~#if fields.[0].name}} {
                {{#each fields}}
                {{name}}: {{{lookup ../../../type_names type}}},
                {{/each}}
            }
            {{~else~}}
            ({{#each fields}}{{{lookup ../../../type_names type}}}{{#unless @last}}, {{/unless}}{{/each}})
            {{~/if}}{{~/if}},
        {{/each}}
        }
{{else}}
    {{#if type.def.composite}}
        {{#if type.def.composite.fields.[0]}}
        {{#if type.def.composite.fields.[0].name}}
        struct {{{lookup ../type_names id}}} {
            {{#each type.def.composite.fields}}
            {{name}}: {{{lookup ../../type_names type}}},
            {{/each}}
        }
        {{else}}
        struct {{{lookup ../type_names id}}}({{#each type.def.composite.fields}}{{{lookup ../../type_names type}}}{{#unless @last}}, {{/unless}}{{/each}});
        {{/if}}
        {{/if}}
    {{else}}
        struct {{{lookup ../type_names id}}};
    {{/if}}
{{/if}}
{{#unless @last}}

{{/unless}}
{{/each}}
    }
    {{/if}}
}
