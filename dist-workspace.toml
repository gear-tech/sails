[workspace]
members = ["cargo:rs/cli"]

# Config for 'dist'
[dist]
# The preferred dist version to use in CI (Cargo.toml SemVer syntax)
cargo-dist-version = "0.31.0"
# CI backends to support
ci = "github"
# The installers to generate for each app
installers = ["shell", "powershell"]
# Target platforms to build apps for (Rust target-triple syntax)
targets = [
    "aarch64-apple-darwin",
    "x86_64-apple-darwin",
    "x86_64-unknown-linux-gnu",
    "x86_64-pc-windows-msvc",
]
# Path that installers should place binaries in
install-path = "CARGO_HOME"
# Whether to install an updater program
install-updater = true
# Globally disable dist, so we can opt-in specific packages
dist = false
# Use precise builds to avoid workspace ambiguity
precise-builds = true
# Specify which packages should be distributed
packages = ["sails-cli"]
# Run 'dist plan' in PRs to verify configuration (don't upload artifacts)
pr-run-mode = "plan"
# Don't create a release; wait for the existing draft from rs-publish.yml
create-release = false
# Allow manual edits to the CI workflow name and triggers. 
# This config is used specifically for managing the .github/workflows/bin-release.yml file 
# which is called by .github/workflows/rs-release.yml.
# IMPORTANT: To regenerate or update the workflow, you must temporarily disable 'allow-dirty', 
# run 'dist generate', and then re-enable it to preserve manual customizations:
# 1. Restore 'workflow_call' trigger instead of 'on: push'.
# 2. Add 'ref: ${{ inputs.tag }}' to all 'actions/checkout' steps.
# 3. Update 'dist plan' and 'dist host' commands to use '--tag=${{ inputs.tag }}'.
allow-dirty = ["ci"]
# Static link the C runtime on Windows for better portability
msvc-crt-static = true
